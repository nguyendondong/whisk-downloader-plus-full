<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Whisk Downloader Plus</title>
<link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div class="app">
    <header><h2>Whisk Downloader Plus</h2></header>

    <div class="tabs">
      <button id="tab-source" class="tab active">Prompt Source</button>
      <button id="tab-download" class="tab">Download Settings</button>
      <button id="tab-timing" class="tab">Timing Control</button>
      <button id="tab-logs" class="tab">Logs</button>
    </div>

    <div id="panel-source" class="panel">


      <label class="row">Import CSV / TXT:
        <input id="fileInput" type="file" accept=".csv,.txt,.xlsx" />
      </label>
      <div class="row small">
        <label>Rows loaded: <span id="rowsCount">0</span></label>
        <label style="float:right">Preview lines: <input id="previewLines" type="number" value="10" min="1" max="100" /></label>
      </div>
      <textarea class="preview-box" id="previewBox" placeholder="Preview of loaded prompts..."></textarea>

      <div class="row">
        <label>Images per prompt:
          <select id="imagesPerPrompt"><option selected>1</option><option>2</option></select>
        </label>
        <label>Image index to download (1-based): <input id="imageIndex" type="number" value="1" min="1" /></label>
      </div>
    </div>

    <div id="panel-download" class="panel hidden">
      <div class="row"><label>Folder name (prefix in filename): <input id="prefixInput" type="text" /></label></div>
      <div class="row"><label>Filename template: <input id="fileTemplate" type="text" /></label></div>
      <div class="row"><label>Download as ZIP? <input id="downloadZip" type="checkbox" /></label></div>
    </div>

    <div id="panel-timing" class="panel hidden">
      <div class="row"><label>Min wait after send (ms): <input id="minWaitMs" type="number" value="2500" /></label></div>
      <div class="row"><label>Timeout render per prompt (ms): <input id="timeoutMs" type="number" value="60000" /></label></div>
      <div class="row"><label>Extra wait after render (ms): <input id="afterRenderWaitMs" type="number" value="5000" /></label></div>
      <div class="row"><label>Delay between prompts (ms): <input id="betweenPromptsMs" type="number" value="3500" /></label></div>
      <div class="row"><label>Max retries per prompt: <input id="maxRetries" type="number" value="3" min="1" /></label></div>
      <div class="row"><label>Retry delay (ms): <input id="retryDelayMs" type="number" value="3000" min="0" /></label></div>
    </div>

    <div id="panel-logs" class="panel hidden">
      <div class="row">
        <button id="clearLogs">Clear</button>
        <button id="exportLog">Export Log</button>
      </div>
      <textarea id="logBox" readonly></textarea>
    </div>

    <div class="bottom">
      <div class="status">
        <span id="statusLabel">idle</span> &nbsp; <span id="progressLabel">0/0</span>
      </div>
      <div class="controls">
        <button id="startBtn" class="btn-green">Start</button>
        <button id="stopBtn" disabled class="btn-red">Stop</button>
        <button id="resetBtn">Reset</button>
      </div>
    </div>
  </div>

<script src="utils.csvParser.js"></script>
<script src="popup.js"></script>
</body>
</html>
